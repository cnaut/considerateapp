<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
    
    <title>PhoneGap WP7</title>
    
	  <link rel="stylesheet" href="master.css" type="text/css" media="screen" title="no title" charset="utf-8"/>
            
      <script type="text/javascript" charset="utf-8" src="phonegap-1.4.1.js"></script>
       
    
      <script type="text/javascript">

        //var pictureSource;
        //var destinationType;

        document.addEventListener("deviceready",onDeviceReady,false);

        // once the device ready event fires, you can safely do your thing! -jm
        function onDeviceReady()
        {
          //pictureSource = navigator.camera.pictureSourceType;
          //destinationType = navigator.camera.DestinationType;

        }

        function getPhoto() {
          // Retrieve image file location from specified source
          navigator.camera.getPicture(onSuccess, onFail, {sourceType:Camera.PictureSourceType.SAVEDPHOTOALBUM});
        }

        function onSuccess(imageURI) {


          //Uncomment to view the image file URI
          //console.log(imageURI);
          
          //alert('Error Getting picture ndskvaksdkhf');
          // Get image handle
          var image = document.getElementById('image');

          // Unhide image elements
          image.style.visibility = 'visible';

          var button = document.getElementById('save_button');
          button.disabled = false;

          // Show the captured photo
          // The inline CSS rules are used to resize the image
          //image.src = "data:image/jpeg;base64," + imageURI;
          image.src = imageURI;
        }

        function onFail(message) {
          alert('Error Getting picture');
        }
        
        function sendRequest() {
          var image = document.getElementById("image");
          var name = document.getElementById("name");
          
          var xmlhttp = new XMLHttpRequest();
          xmlhttp.onreadystatechange=function() {
            if(xmlhttp.readyState == 4 && xmlhttp.status == 200) {
              
            }
          }
          xmlhttp.open("POST", "http://184.169.136.30:8002/users", true);
          xmlhttp.send("name=" + name.text + "&photo=" + image.src);
        }

      </script>
    
      
  </head>
  <body>
    <h1>Profile!</h1>

    <div>
      
      
      Enter your name<input type="text" name ="name"></input>
      
      <button id="photo_button" onclick="getPhoto();">Select Photo</button> <br/>
      <img id="image" height = "200" width = "200" style="visibility:hidden" src="" />
      <button id="save_button" disabled="true" onclick="sendRequest();">Save</button>

      <!--"location.href='nearby.html';">Save</button>-->


    </div>
    
    <!--<div id="welcomeMsg"></div>-->
    
  </body>
</html>
